<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <title>달려</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="./assets/css/normalize.css">
    <style>
        html, body{height: 100%; overflow: hidden;}
        canvas{background: #000;}

    </style>
</head>


<body>
    <canvas onclick="pushpush(event);" ontouchstart="pushpush(event);"></canvas>

    <script>
        const getRandomNum = (mn, mx) => Math.floor(Math.random() * (mx - mn + 1)) + mn;

        const canvas = document.querySelector('canvas');
        const ctx = canvas.getContext('2d');

        const mxJumpHeight = 100;
        const jumpSpeed = 10;


        let raf;
        let rafTimer = 0;
        let isJump = false;

        let btn1, btn2, btn3, btn4, btn5;

        const obj2Arr = [];

        const window_w = window.innerWidth; 
        const window_h = window.innerHeight;

        canvas.width = window_w;
        canvas.height = window_h;

        const colorArr = ['#ACD7F2', '#C0D966', '#F2B705', '#F28241', '#F20505'];

        class Obj1 {
            constructor(rdmNum){
                this.x = 10 + (rdmNum * 50);
                this.y = canvas.height - 10 - 50;
                this.w = 40;
                this.h = 10;
                this.bg = colorArr[rdmNum];
                this.speed = rdmNum * 2;

            }
            draw(){
                ctx.fillStyle = this.bg + '40';
                ctx.fillRect(this.x, 0, 40, canvas.height);
                ctx.fill();

                ctx.fillStyle = this.bg;
                ctx.fillRect(this.x, this.y, this.w, this.h);
                ctx.fill();
            }
        }

        class Obj2 {
            constructor(rdmNum){
                this.x = 10 + (rdmNum * 50);
                this.y = 0;
                this.w = 40;
                this.h = 10;
                this.bg = colorArr[rdmNum];
                this.speed = 2;
            }
            draw(){
                ctx.fillStyle = this.bg;
                ctx.fillRect(this.x, this.y, this.w, this.h);
                ctx.fill();
            }
        }

        // ctx.beginPath();
        // ctx.moveTo(0, 150);
        // ctx.lineTo(window_w, 150);
        // ctx.stroke();

        function gameStart(){
            rafTimer++;
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            // if(isJump){
            //     obj1.y -= jumpSpeed;
            //     if(obj1.y < mxJumpHeight){
            //         isJump = false;
            //     }
            // }else{
            //     obj1.y += jumpSpeed;
            //     if(obj1.y > 200) obj1.y = 200;
            // }
            // obj1.draw();

            const obj1_1 = new Obj1(0);
            const obj1_2 = new Obj1(1);
            const obj1_3 = new Obj1(2);
            const obj1_4 = new Obj1(3);
            const obj1_5 = new Obj1(4);

            obj1_1.draw();
            obj1_2.draw();
            obj1_3.draw();
            obj1_4.draw();
            obj1_5.draw();

            


            if(rafTimer % 10 === 0){
                const obj2 = new Obj2(getRandomNum(0, colorArr.length - 1));
                obj2Arr.push(obj2);
            }



            obj2Arr.forEach(function(el, i, o){
                if(el.y > canvas.height - 10 - 50) o.splice(i, 1);
                el.y += (el.speed + 1);
                el.draw();
            })


            
            raf = window.requestAnimationFrame(gameStart);

        }

        gameStart();

        // canvas.addEventListener('click', aaa);


        function pushpush(e, key){
            e.preventDefault();

            let x, y;

            if(e.type === 'click'){
                x = e.offsetX;
                y = e.offsetY;
                
            }else if(e.type === 'touchstart'){
                x = e.touches[0].clientX;
                y = e.touches[0].clientY;
            }

            console.log(x);
            console.log(y);

            if(9 < x && x < 51){
                btn1 = '';
            }
            if(59 < x && x < 101){
                btn2 = '';
            }
            if(109 < x && x < 151){
                btn3 = '';
            }
            if(159 < x && x < 201){
                btn4 = '';
            }
            if(209 < x && x < 251){
                btn5 = '';
            }

        }


        
    </script>
</body>

</html>